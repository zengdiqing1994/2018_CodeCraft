### 分析

2018年的华为软挑，考察了机器学习和云计算相关的知识，这里我们要根据上一周或者上几周客户申请的虚拟机的类型和相应的数量，预测出下一周或者一段时间之内各类型虚拟机的申请情况。在预测的基础上，用尽量少的数量的服务器去放置预测出来的所有虚拟机。

用一个通俗的例子来说，卖电脑的某宝店主，根据前两个三个月的电脑销售记录，推测接下来一周会有多少型号的电脑会被买走。

发货时候，希望用尽量少的箱子将这些电脑打包装好，再邮寄出去。

### 预测部分

预测部分说白了就是一个“拟合”问题，因为是结构化的数据，所以脑海里首先想到的是“线性回归”，然后发现，线性回归去拟合和预测数据，过于简单粗暴，很多细节都会丢失，也就是我们所说的“过拟合”，百分制的练习阶段，我们的成绩只有53-55，简直了。。。

后面考虑到减少“过拟合”的问题，使用局部加权回归，好像也没有多大改进，于是讨论出了下面的方法。

#### 指数平滑

经典的基于时序序列的预测问题，在金融领域利用的多的有“指数平滑”，“ARIMA”等，在现今火热的深度学习领域，LSTM也是首当其冲。我们采用了指数平滑的方法，分为一次，二次，三次指数平滑。

一次指数平滑![](https://img-blog.csdnimg.cn/20190219100039110.png)，其中，St是时间t+1期的预测值，即t期的平滑值；Yt为t期的实际值，St-1为t期的预测值，t-1期的平滑值；α为平滑系数，又称加权因子，取值范围为[0,1]，通常经过反复试算来确定α的最优值(最小均方误差)。

我们把![](https://img-blog.csdnimg.cn/20190219100550586.png)依次带入上式，可以得到下面的式子：

![](https://img-blog.csdnimg.cn/20190219100651640.png)

从上式中可以看出，一次指数平滑实际上是以![](https://img-blog.csdnimg.cn/20190219100759882.png)为权值的加权移动平均法。由于k越大，![](https://img-blog.csdnimg.cn/20190219100759882.png)越小，所以越是远期的实际值对未来时期平滑值的影响就越小。最后一项初始平滑值S0通常为最初几个实测值的平均值来替代。

二次指数平滑法其实就是对一次指数平滑法再多一次指数平滑，求出一次指数平滑值和二次指数平滑值得差值，然后将差值加到一次指数平滑值上，再加上趋势变动值便可得到近似于实际值的测量值。

机器学习离不了公式，结合本题目的场景：

假设我们获取了过去一段时间T(比如一年)内的虚拟机请求数据，我们以t(比如一个月)把时间段T进行等份划分，那么可以划分成I（如I=12）等份。

假设虚拟机的规格(flavor)集合为 F = {1,2,....f,...|F|}，共有|F|种不同规格的虚拟机类型(flavor)：假设所有规格的虚拟机增量集合为M={M1,M2,..M|F|},其中Mf=![](https://img-blog.csdnimg.cn/20190219101812738.png)，即![](https://img-blog.csdnimg.cn/20190219101932857.png)表示第f种规格的虚拟机在第i个t时间段内的增量，用![](https://img-blog.csdnimg.cn/20190219102058899.png)表示第i个t时间段内用户申请的规格为f的虚拟机数量，则有：

![](https://img-blog.csdnimg.cn/20190219102218923.png)

对Mf通过下面的公式可以得到一次指数平滑值：

![](https://img-blog.csdnimg.cn/20190219102416180.png)

而如果要对第i+n期的虚拟机数量增量进行预测，需要通过以下二次指数平滑预测模型：

![](https://img-blog.csdnimg.cn/20190219102623198.png)

并且二次指数平滑与一次指数平滑值得递推公式为：

![](https://img-blog.csdnimg.cn/20190219102820835.png)

这时候，对第I+1期进行预测，根据公式（5）可得：

![](https://img-blog.csdnimg.cn/2019021910300955.png)

由此可以得到第I+1期的虚拟机预测集合 ![](https://img-blog.csdnimg.cn/20190219103137537.png)，根据预测结果，可以计算虚拟机总数：

![](https://img-blog.csdnimg.cn/20190219103216189.png)

当然，依次类推，我们还可以得到三次指数平滑表达式，但并不是次数越高越好，得看具体训练数据集而定。本题中使用三次指数平滑效果是要比二次要好的。
